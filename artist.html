<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Профиль артиста — NikoFlow</title>
  <style>
    :root {
      --bg-light: #fefefe;
      --text-light: #222;
      --bg-dark: #121212;
      --text-dark: #eee;
      --primary: #7c3aed;
      --spotify-green: #1db954;
      --wiki-blue: #3366cc;
      --red-badge: #dc2626;
    }
    body {
      margin: 0; padding: 1rem;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg-light);
      color: var(--text-light);
      transition: background-color 0.3s, color 0.3s;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    body.dark {
      background: var(--bg-dark);
      color: var(--text-dark);
    }
    .container {
      max-width: 900px;
      width: 100%;
      text-align: center;
    }
    h1 {
      font-size: 3rem;
      font-weight: 900;
      color: var(--primary);
      margin-bottom: 0.3rem;
      user-select: none;
    }
    .badge {
      display: none;
      background-color: var(--red-badge);
      color: white;
      font-weight: 700;
      border-radius: 1rem;
      padding: 0.3rem 0.7rem;
      user-select: none;
      margin-bottom: 1rem;
      display: inline-block;
    }
    img.artist-image {
      width: 280px;
      height: 280px;
      object-fit: cover;
      border-radius: 1.5rem;
      margin-bottom: 1rem;
      box-shadow: 0 8px 32px rgba(124, 58, 237, 0.7);
      user-select: none;
    }
    .links a {
      display: inline-block;
      margin: 0 1rem;
      padding: 0.8rem 2rem;
      border-radius: 2rem;
      color: white;
      font-weight: 700;
      text-decoration: none;
      transition: background-color 0.3s ease;
      user-select: none;
    }
    a.spotify {
      background-color: var(--spotify-green);
      box-shadow: 0 0 15px #1db954cc;
    }
    a.spotify:hover {
      background-color: #17a44c;
      box-shadow: 0 0 25px #17a44ccc;
    }
    a.wikipedia {
      background-color: var(--wiki-blue);
      box-shadow: 0 0 15px #3366cccc;
    }
    a.wikipedia:hover {
      background-color: #254b9a;
      box-shadow: 0 0 25px #254b9acc;
    }
    #description {
      margin-top: 2rem;
      line-height: 1.6;
      font-size: 1.1rem;
      max-width: 800px;
      user-select: text;
    }
    .theme-toggle {
      position: fixed;
      top: 1rem;
      right: 1rem;
      padding: 0.5rem 1rem;
      border-radius: 1rem;
      background: var(--primary);
      color: white;
      font-weight: 700;
      border: none;
      cursor: pointer;
      user-select: none;
      z-index: 10000;
    }
  </style>
</head>
<body>
  <button class="theme-toggle" id="theme-toggle">Тёмная тема</button>
  <div class="container" role="main" aria-live="polite">
    <button onclick="history.back()" style="margin-bottom:1rem; cursor:pointer;">← Назад</button>
    <h1 id="artist-name">Загрузка...</h1>
    <div class="badge" id="foreign-agent-badge">Признан иноагентом в РФ</div>
    <img src="" alt="Фото артиста" class="artist-image" id="artist-image" />
    <div class="links">
      <a href="#" target="_blank" rel="noopener" id="spotify-link" class="spotify">Spotify</a>
      <a href="#" target="_blank" rel="noopener" id="wiki-link" class="wikipedia">Википедия</a>
    </div>
    <div id="description">Загрузка описания...</div>
  </div>

  <script>
    const foreignAgents = [
      "Noize MC",
      "Монеточка",
      // Добавь сюда артистов, которым показывать бейдж
    ];

    // Получаем имя артиста из URL
    const params = new URLSearchParams(window.location.search);
    let artistName = params.get('name') || '';

    if (!artistName) {
      document.getElementById('artist-name').textContent = 'Артист не указан';
      document.getElementById('description').textContent = '';
    } else {
      artistName = decodeURIComponent(artistName);

      // Показываем имя
      document.getElementById('artist-name').textContent = artistName;

      // Показать бейдж, если артист в списке иноагентов
      const badge = document.getElementById('foreign-agent-badge');
      if (foreignAgents.includes(artistName)) {
        badge.style.display = 'inline-block';
      } else {
        badge.style.display = 'none';
      }

      // Формируем ссылку на Spotify (через поиск)
      const spotifySearchUrl = `https://open.spotify.com/search/${encodeURIComponent(artistName)}`;
      const spotifyLink = document.getElementById('spotify-link');
      spotifyLink.href = spotifySearchUrl;
      spotifyLink.setAttribute('aria-label', `Spotify поиск по артисту ${artistName}`);

      // Ссылка на русскую Википедию
      const wikiUrl = `https://ru.wikipedia.org/wiki/${encodeURIComponent(artistName)}`;
      const wikiLink = document.getElementById('wiki-link');
      wikiLink.href = wikiUrl;
      wikiLink.setAttribute('aria-label', `Википедия - страница артиста ${artistName}`);

      // Загрузка описания из Википедии (API)
      async function fetchWikiSummary(name) {
        const descElem = document.getElementById('description');
        descElem.textContent = 'Загрузка описания...';
        try {
          const apiUrl = `https://ru.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(name)}`;
          const response = await fetch(apiUrl);
          if (!response.ok) throw new Error('Страница не найдена');
          const data = await response.json();
          if (data.extract) {
            descElem.textContent = data.extract;
            // Подставим изображение, если есть
            if(data.thumbnail && data.thumbnail.source){
              document.getElementById('artist-image').src = data.thumbnail.source;
              document.getElementById('artist-image').alt = `Фото ${artistName}`;
            } else {
              // Если изображения нет, поставим заглушку
              document.getElementById('artist-image').src = 'https://upload.wikimedia.org/wikipedia/commons/a/ac/No_image_available.svg';
              document.getElementById('artist-image').alt = 'Фото недоступно';
            }
          } else {
            descElem.textContent = 'Описание отсутствует.';
            document.getElementById('artist-image').src = 'https://upload.wikimedia.org/wikipedia/commons/a/ac/No_image_available.svg';
            document.getElementById('artist-image').alt = 'Фото недоступно';
          }
        } catch {
          descElem.textContent = 'Не удалось загрузить описание.';
          document.getElementById('artist-image').src = 'https://upload.wikimedia.org/wikipedia/commons/a/ac/No_image_available.svg';
          document.getElementById('artist-image').alt = 'Фото недоступно';
        }
      }
      fetchWikiSummary(artistName);
    }

    // Тёмная тема (сохраняется)
    const themeToggle = document.getElementById('theme-toggle');
    function setTheme(theme) {
      if (theme === 'dark') {
        document.body.classList.add('dark');
        themeToggle.textContent = 'Светлая тема';
        localStorage.setItem('nikoTheme', 'dark');
      } else {
        document.body.classList.remove('dark');
        themeToggle.textContent = 'Тёмная тема';
        localStorage.setItem('nikoTheme', 'light');
      }
    }
    const savedTheme = localStorage.getItem('nikoTheme') || 'light';
    setTheme(savedTheme);
    themeToggle.addEventListener('click', () => {
      const newTheme = document.body.classList.contains('dark') ? 'light' : 'dark';
      setTheme(newTheme);
    });
  </script>
</body>
</html>
